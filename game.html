<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        table {
            border-collapse: collapse; /* Asegura que los bordes de la tabla se colapsen en uno solo */
            width: 100%; /* Establece el ancho de la tabla al 100% del contenedor */
        }
        th, td {
            border: 1px solid black; /* Añade un borde sólido a las celdas de la tabla */
            text-align: left; /* Alinea el texto a la izquierda */
            padding: 8px; /* Añade un relleno alrededor del texto en las celdas */
        }
        th {
            background-color: #f2f2f2; /* Establece un color de fondo para los encabezados de la tabla */
        }
        tr:nth-child(even) {
            background-color: #f9f9f9; /* Establece un color de fondo para las filas pares */
        }


        #gamesContainer {
        max-height: 500px; /* Altura máxima del contenedor */
        overflow-y: auto; /* Habilita el desplazamiento vertical si el contenido excede la altura */
        border: 1px solid #ccc; /* Opcional: añade un borde al contenedor */
    }
    </style>
</head>
<body>
    <button class="start-button" id="startGameButton" ><i class="fas fa-play"></i> Iniciar Juego</button>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
          const startButton = document.getElementById('startGameButton');
          
          startButton.addEventListener('click', function() {
            // Realiza la petición POST sin enviar datos
            fetch('https://parcial-202425-production.up.railway.app/games', {
              method: 'POST', // Método HTTP
              headers: {
                'Content-Type': 'application/json', // Indica el tipo de contenido que se está enviando
              }
              // No se incluye body ya que no se enviarán datos
            })
            .then(response => response.json()) // Convierte la respuesta a JSON
            .then(data => {
              console.log('Success:', data); // Maneja el éxito
            })
            .catch((error) => {
              console.error('Error:', error); // Maneja el error
            });
          });
        });
      </script>


    <div id="gamesContainer">
        <div id="games"></div> <!-- La tabla se insertará aquí -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('https://parcial-202425-production.up.railway.app/games', {
                method: 'GET',
                headers: {
                    'Accept': 'application/json',
                }
            })
            .then(response => response.text())
            .then(text => JSON.parse(text))
            .then(data => {
                console.log('Success:', data);
                
                const gamesContainer = document.getElementById('games');
                gamesContainer.innerHTML = ''; // Limpia el contenedor
                
                // Crea la tabla y sus encabezados
                const table = document.createElement('table');
                const thead = document.createElement('thead');
                const tbody = document.createElement('tbody');
                table.appendChild(thead);
                table.appendChild(tbody);
                
                // Define los encabezados de la tabla
                const headers = ['Game ID', 'Player Name', 'Wins', 'Loses', 'Ties', 'Avatar'];
                const trHead = document.createElement('tr');
                headers.forEach(headerText => {
                    const th = document.createElement('th');
                    th.textContent = headerText;
                    trHead.appendChild(th);
                });
                thead.appendChild(trHead);
                
                // Llena la tabla con los datos de los juegos y jugadores
                data.forEach(game => {
                    if (game.info.players.length > 0) {
                        game.info.players.forEach(player => {
                            const tr = document.createElement('tr');
                            
                            // Celda para el ID del juego
                            const gameIdCell = document.createElement('td');
                            gameIdCell.textContent = game.id;
                            tr.appendChild(gameIdCell);
                            
                            // Celdas para la información del jugador
                            const playerNameCell = document.createElement('td');
                            playerNameCell.textContent = player.name;
                            tr.appendChild(playerNameCell);
                            
                            const winsCell = document.createElement('td');
                            winsCell.textContent = player.wins;
                            tr.appendChild(winsCell);
                            
                            const losesCell = document.createElement('td');
                            losesCell.textContent = player.loses;
                            tr.appendChild(losesCell);
                            
                            const tiesCell = document.createElement('td');
                            tiesCell.textContent = player.ties;
                            tr.appendChild(tiesCell);
                            
                            // Celda para el avatar del jugador
                            const avatarCell = document.createElement('td');
                            const avatarImage = document.createElement('img');
                            avatarImage.src = player.avatar;
                            avatarImage.alt = `Avatar de ${player.name}`;
                            avatarImage.style.width = '50px';
                            avatarCell.appendChild(avatarImage);
                            tr.appendChild(avatarCell);
                            
                            tbody.appendChild(tr);
                        });
                    }
                });
                
                // Añade la tabla al contenedor
                gamesContainer.appendChild(table);
            })
            .catch(error => console.error('Error:', error));
        });
    </script>

</body>
</html>